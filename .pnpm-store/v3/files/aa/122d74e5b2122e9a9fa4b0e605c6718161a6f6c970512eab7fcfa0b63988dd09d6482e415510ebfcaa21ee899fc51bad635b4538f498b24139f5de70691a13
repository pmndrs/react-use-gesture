{"version":3,"file":"core.cjs.development.js","sources":["../src/breakpoints.ts","../src/createBox.ts","../src/propGetters.ts","../src/mediaGetters.ts","../src/transform.ts","../src/customProperties.ts","../src/colorModes.tsx"],"sourcesContent":["/* eslint-disable no-undef */\nimport * as React from 'react'\nimport { getBreakpoints, Theme } from '@xstyled/system'\n\nexport function useThemeBreakpoints(theme: Theme) {\n  return getBreakpoints({ theme })\n}\n\n/**\n * Minimum breakpoint width.\n * Null for the smallest breakpoint.\n */\nfunction useThemeMinValue(theme: Theme, key: string | number) {\n  const breakpoints = useThemeBreakpoints(theme)\n  const value = breakpoints[key]\n  return value === 0 ? null : value\n}\n\n/**\n * Maximum breakpoint width. Null for the largest (last) breakpoint.\n * The maximum value is calculated as the minimum of the next one less 0.02px\n * to work around the limitations of `min-` and `max-` prefixes and viewports with fractional widths.\n * See https://www.w3.org/TR/mediaqueries-4/#mq-min-max\n * Uses 0.02px rather than 0.01px to work around a current rounding bug in Safari.\n * See https://bugs.webkit.org/show_bug.cgi?id=178261\n */\nfunction useThemeMaxValue(theme: Theme, key: string | number) {\n  const breakpoints = useThemeBreakpoints(theme)\n  const breakPoint = breakpoints[key]\n  return breakPoint === 0 ? null : breakPoint - 0.02\n}\n\nexport function useViewportWidth() {\n  const [width, setWidth] = React.useState(\n    typeof window === 'undefined' ? null : window.innerWidth,\n  )\n\n  React.useEffect(() => {\n    function handleResize() {\n      setWidth(window.innerWidth)\n    }\n\n    // Add the listener, then setWidth to avoid race.\n    window.addEventListener('resize', handleResize)\n    setWidth(window.innerWidth)\n\n    return () => window.removeEventListener('resize', handleResize)\n  }, [])\n\n  return width\n}\n\nexport function useThemeBreakpoint(theme: Theme) {\n  const breakpoints = useThemeBreakpoints(theme)\n  const width = useViewportWidth()\n  return React.useMemo(() => {\n    return (\n      Object.keys(breakpoints)\n        .reverse()\n        .find(\n          (breakpoint) => width !== null && width > breakpoints[breakpoint],\n        ) || null\n    )\n  }, [breakpoints, width])\n}\n\nexport function useThemeUp(theme: Theme, key: string | number) {\n  const value = useThemeMinValue(theme, key)\n  const width = useViewportWidth()\n  return width !== null && value !== null && width >= value\n}\n\nexport function useThemeDown(theme: Theme, key: string | number) {\n  const value = useThemeMaxValue(theme, key)\n  const width = useViewportWidth()\n  return width !== null && value !== null && width < value\n}\n","import { system } from '@xstyled/system'\n\nexport function createBox() {\n  return [`&&{`, system, `}`]\n}\ncreateBox.meta = system.meta\n","import {\n  getSpace,\n  getColor,\n  getRadius,\n  getBorder,\n  getBorderWidth,\n  getBorderStyle,\n  getShadow,\n  getSize,\n  getZIndex,\n  getFont,\n  getFontSize,\n  getLineHeight,\n  getFontWeight,\n  getLetterSpacing,\n  getTransition,\n  getInset,\n  getAnimation,\n  getTimingFunction,\n  getTransform,\n  getTransitionProperty,\n  getDuration,\n} from '@xstyled/system'\n\nconst getNumber = (transform: Function) => (value: any) => {\n  const num = Number(value)\n  return transform(Number.isNaN(num) ? value : num)\n}\n\nconst SPACES = /\\s+/\nconst getMultiDimensions = (transform: Function) => (value: any) => {\n  const values = value.split(SPACES)\n  return (p: object) =>\n    values.map((value: any) => transform(value)(p)).join(' ')\n}\n\nconst COMMA = /\\s*,\\s*/\nconst getMultiValues = (transform: Function) => (value: any) => {\n  const values = value.split(COMMA)\n  return (p: object) =>\n    values.map((value: any) => transform(value)(p)).join(',')\n}\n\nconst getNumberInset = getNumber(getInset)\n\nconst getNumberSpace = getNumber(getSpace)\nconst getMultiNumberSpace = getMultiDimensions(getNumberSpace)\n\nconst getNumberBorder = getNumber(getBorder)\n\nconst getNumberBorderWidth = getNumber(getBorderWidth)\nconst getMultiNumberBorderWidth = getMultiDimensions(getNumberBorderWidth)\n\nconst getNumberSize = getNumber(getSize)\n\nconst getMultiBorderStyle = getMultiDimensions(getBorderStyle)\n\nexport const propGetters = {\n  // getSpace\n  margin: getMultiNumberSpace,\n  'margin-top': getNumberSpace,\n  'margin-bottom': getNumberSpace,\n  'margin-left': getNumberSpace,\n  'margin-right': getNumberSpace,\n  padding: getMultiNumberSpace,\n  'padding-top': getNumberSpace,\n  'padding-bottom': getNumberSpace,\n  'padding-left': getNumberSpace,\n  'padding-right': getNumberSpace,\n  gap: getMultiNumberSpace,\n  'grid-gap': getMultiNumberSpace,\n  'row-gap': getNumberSpace,\n  'grid-row-gap': getNumberSpace,\n  'column-gap': getNumberSpace,\n  'grid-column-gap': getNumberSpace,\n\n  // getColor\n  color: getColor,\n  'background-color': getColor,\n  'border-color': getColor,\n  'border-top-color': getColor,\n  'border-right-color': getColor,\n  'border-bottom-color': getColor,\n  'border-left-color': getColor,\n  'outline-color': getColor,\n  fill: getColor,\n  stroke: getColor,\n\n  // getRadius\n  'border-radius': getMultiDimensions(getNumber(getRadius)),\n  'border-top-left-radius': getMultiDimensions(getNumber(getRadius)),\n  'border-top-right-radius': getMultiDimensions(getNumber(getRadius)),\n  'border-bottom-right-radius': getMultiDimensions(getNumber(getRadius)),\n  'border-bottom-left-radius': getMultiDimensions(getNumber(getRadius)),\n\n  // getBorder\n  border: getNumberBorder,\n  'border-top': getNumberBorder,\n  'border-right': getNumberBorder,\n  'border-bottom': getNumberBorder,\n  'border-left': getNumberBorder,\n\n  // getBorderWidth\n  'border-width': getMultiNumberBorderWidth,\n  'border-top-width': getNumberBorderWidth,\n  'border-right-width': getNumberBorderWidth,\n  'border-bottom-width': getNumberBorderWidth,\n  'border-left-width': getNumberBorderWidth,\n  'outline-width': getNumberBorderWidth,\n\n  // getBorderStyle\n  'border-style': getMultiBorderStyle,\n  'border-top-style': getBorderStyle,\n  'border-right-style': getBorderStyle,\n  'border-bottom-style': getBorderStyle,\n  'border-left-style': getBorderStyle,\n  'outline-style': getBorderStyle,\n\n  // getShadow\n  'box-shadow': getMultiValues(getShadow),\n  'text-shadow': getMultiValues(getShadow),\n\n  // getSize\n  width: getNumberSize,\n  height: getNumberSize,\n  'max-width': getNumberSize,\n  'max-height': getNumberSize,\n  'min-width': getNumberSize,\n  'min-height': getNumberSize,\n  'mask-size': getMultiValues(getNumberSize),\n\n  // getZIndex\n  'z-index': getNumber(getZIndex),\n\n  // getFont\n  'font-family': getFont,\n\n  // getFontSize\n  'font-size': getNumber(getFontSize),\n\n  // getLineHeight\n  'line-height': getNumber(getLineHeight),\n\n  // getFontWeight\n  'font-weight': getFontWeight,\n\n  // getLetterSpacing\n  'letter-spacing': getNumber(getLetterSpacing),\n\n  // getTransition\n  transition: getTransition,\n\n  // getDuration\n  'transition-duration': getDuration,\n  'animation-duration': getDuration,\n\n  // getAnimation\n  animation: getAnimation,\n\n  // getInset\n  top: getNumberInset,\n  right: getNumberInset,\n  bottom: getNumberInset,\n  left: getNumberInset,\n\n  // getTimingFunction\n  'animation-timing-function': getTimingFunction,\n  'transition-timing-function': getTimingFunction,\n\n  // getTransform\n  transform: getTransform,\n\n  // getTransitionProperty\n  'transition-property': getTransitionProperty,\n}\n","import {\n  getBreakpoints,\n  getBreakpointMin,\n  getBreakpointMax,\n} from '@xstyled/system'\n\nconst getMediaWidth = (getBreakpointBound: Function) => (value: any) => (\n  props: object,\n) => {\n  const v = getBreakpointBound(getBreakpoints(props), value)\n  // getters return null for smallest, undefined for not found, and otherwise\n  // a px string. Since we MUST emit a matcher at this point, use 0px for the\n  // smallest case (always true for min, never true for max).\n  return v === null ? '0' : v || value\n}\n\nexport const mediaGetters = {\n  'min-width': getMediaWidth(getBreakpointMin),\n  'max-width': getMediaWidth(getBreakpointMax),\n}\n","/* eslint-disable no-continue, no-loop-func, no-cond-assign */\nimport { mediaGetters } from './mediaGetters'\nimport { propGetters } from './propGetters'\n\n// prop name is an ident: word chars, underscore and dash.\nconst PROP_CHAR = `[-\\\\w]`\n\n// prop value consists of non-semis and no curly braces unless backslash-escaped.\n// This uses [\\s\\S] instead of . because IE11 doesn't support the s flag.\nconst VALUE_CHAR = `(?:\\\\\\\\[\\\\s\\\\S]|[^\\\\\\\\;{}])`\n\n// prettier-ignore\nconst PROP_PATT = (\n  `(${PROP_CHAR}+)` +   // capture prop name\n  `(\\\\s*:\\\\s*)` +       // colon & whitespace\n  `(?=\\\\S)` +           // prop value starts with non-whitespace\n  `(${VALUE_CHAR}*?)` + // capture prop value (non-greedy)\n  `(\\\\s*!important)?` + // capture !important\n  `(\\\\s*;)`             // semi & whitespace\n)\n\n// simplistic but workable media query value.\nconst MEDIA_CHAR = `[^{]`\n\n// prettier-ignore\nconst MEDIA_PATT = (\n  `(@media\\\\b\\\\s*)` +   // start of media query\n  `(?=\\\\S)` +           // value starts with non-whitespace\n  `(${MEDIA_CHAR}+?)` + // capture queries (non-greedy)\n  `(\\\\s*\\\\{)`           // brace & whitespace\n)\n\nconst MATCH_REGEXP = new RegExp(`(?:${PROP_PATT}|${MEDIA_PATT})`, `g`)\n\nexport function transform(rawValue: any) {\n  if (typeof rawValue !== 'string') return rawValue\n  let matches\n  let lastIndex = 0\n  const values = []\n  while ((matches = MATCH_REGEXP.exec(rawValue))) {\n    const [, prop, colon, value, imp, semi, media, query, brace] = matches\n    if (media) {\n      values.push(rawValue.slice(lastIndex, matches.index))\n      values.push(media)\n      mediaTransform(query).forEach((v) => values.push(v))\n      values.push(brace)\n      lastIndex = matches.index + matches[0].length\n    } else {\n      const getter = (propGetters as any)[prop]\n      if (getter) {\n        values.push(rawValue.slice(lastIndex, matches.index))\n        values.push(\n          (p: object) =>\n            `${prop}${colon}${getter(value)(p)}${imp || ''}${semi}`,\n        )\n        lastIndex = matches.index + matches[0].length\n      }\n    }\n  }\n  values.push(rawValue.slice(lastIndex, rawValue.length))\n  return values\n}\n\n// media query prop/value pairs such as (min-width: 1024px)\n// prettier-ignore\nconst QUERY_REGEXP = new RegExp(\n  `(\\\\(\\\\s*)` +       // open paren, whitespace\n  `(${PROP_CHAR}+)` + // capture prop name\n  `(\\\\s*:\\\\s*)` +     // colon & whitespace\n  `([^\\\\)]*?)` +      // capture prop value (non-greedy)\n  `(\\\\s*\\\\))`,        // close paren, whitespace\n  `g`\n)\n\nfunction mediaTransform(rawValue: string) {\n  let matches\n  let lastIndex = 0\n  const values = []\n  while ((matches = QUERY_REGEXP.exec(rawValue))) {\n    const [, open, prop, colon, value, close] = matches\n    const getter = (mediaGetters as any)[prop]\n    if (getter) {\n      values.push(rawValue.slice(lastIndex, matches.index))\n      values.push(\n        (p: object) => `${open}${prop}${colon}${getter(value)(p)}${close}`,\n      )\n      lastIndex = matches.index + matches[0].length\n    }\n  }\n  values.push(rawValue.slice(lastIndex, rawValue.length))\n  return values\n}\n","import { obj, string, func, cascade } from '@xstyled/util'\n\nconst join = (...args: (string | undefined)[]): string =>\n  args.filter(Boolean).join('.')\n\nconst toVarName = (key: string): string => `--${key.replace(/\\./g, '-')}`\nconst toVarValue = (key: string, value: string): string =>\n  `var(${toVarName(key)}, ${value})`\nconst toProp = (key: string, value: string): string => `${key}: ${value};`\n\nexport function toCustomPropertiesReferences<\n  T extends Record<string | number, unknown>\n>(\n  values: T,\n  theme?: object,\n  keys: string[] = Object.keys(values),\n  parent?: string,\n): Record<string | number, unknown> {\n  const next: Record<string | number, unknown> = Array.isArray(values)\n    ? ([] as Record<number, string>)\n    : ({} as Record<string, string>)\n\n  for (const i in keys) {\n    const key = keys[i]\n    const value = values[key]\n    const name = join(parent, key)\n    if (obj(value)) {\n      next[key] = toCustomPropertiesReferences(\n        value as { [key: string]: unknown },\n        theme,\n        Object.keys(value),\n        name,\n      )\n      continue\n    }\n    if (string(value)) {\n      next[key] = toVarValue(name, value)\n      continue\n    }\n    if (func(value)) {\n      next[key] = toVarValue(name, cascade(value, { theme }))\n      continue\n    }\n  }\n\n  return next\n}\n\nexport function toCustomPropertiesDeclarations(\n  values: { [key: string]: unknown },\n  theme?: object,\n  keys: string[] = Object.keys(values),\n  parent?: string,\n  state = { value: '' },\n): string {\n  for (const i in keys) {\n    const key = keys[i]\n    const value = values[key]\n    const name = join(parent, key)\n    if (obj(value)) {\n      toCustomPropertiesDeclarations(\n        value as { [key: string]: unknown },\n        theme,\n        Object.keys(value),\n        name,\n        state,\n      )\n      continue\n    }\n    if (string(value)) {\n      state.value += toProp(toVarName(name), value)\n      continue\n    }\n    if (func(value)) {\n      state.value += toProp(toVarName(name), cascade(value, { theme }))\n      continue\n    }\n  }\n\n  return state.value\n}\n","/* eslint-disable @typescript-eslint/no-empty-function */\n/* eslint-disable react/no-danger */\n/* eslint-env browser */\nimport * as React from 'react'\nimport {\n  toCustomPropertiesDeclarations,\n  toCustomPropertiesReferences,\n} from './customProperties'\n\ntype ColorModeState = [string | null, (mode: string | null) => void]\ntype Color = string | ((props: Record<string, unknown>) => Color)\ntype Colors = Record<string, Color>\n\ninterface ITheme {\n  useCustomProperties?: boolean\n  useColorSchemeMediaQuery?: boolean\n  initialColorModeName?: string\n  defaultColorModeName?: string\n  colors?: Colors & {\n    modes?: Record<string, Colors>\n  }\n}\n\ninterface IColorModeTheme extends ITheme {\n  colors: Colors & { modes: Record<string, Colors> }\n}\n\nconst STORAGE_KEY = 'xstyled-color-mode'\n\nconst isLocalStorageAvailable: boolean =\n  typeof window !== 'undefined' &&\n  (() => {\n    try {\n      const key = 'xstyled-test-key'\n      window.localStorage.setItem(key, key)\n      window.localStorage.removeItem(key)\n      return true\n    } catch (err) {\n      return false\n    }\n  })()\n\ninterface Storage {\n  get(): string | null\n  set(value: string): void\n  clear(): void\n}\n\nconst storage: Storage = isLocalStorageAvailable\n  ? {\n      get: () => window.localStorage.getItem(STORAGE_KEY),\n      set: (value: string) => {\n        window.localStorage.setItem(STORAGE_KEY, value)\n      },\n      clear: () => window.localStorage.removeItem(STORAGE_KEY),\n    }\n  : {\n      get: () => null,\n      set: () => {},\n      clear: () => {},\n    }\n\nconst COLOR_MODE_CLASS_PREFIX = 'xstyled-color-mode-'\nconst getColorModeClassName = (mode: string) =>\n  `${COLOR_MODE_CLASS_PREFIX}${mode}`\n\nconst XSTYLED_COLORS_PREFIX = 'xstyled-colors'\nconst SYSTEM_MODES = ['light', 'dark']\n\nfunction getModeTheme(theme: IColorModeTheme, mode: string): IColorModeTheme {\n  return {\n    ...theme,\n    colors: { ...theme.colors, ...theme.colors.modes[mode] },\n  }\n}\n\nconst getMediaQuery = (query: string): string => `@media ${query}`\nconst getColorModeQuery = (mode: string): string =>\n  `(prefers-color-scheme: ${mode})`\n\nfunction checkHasColorModes(theme: ITheme | null): theme is IColorModeTheme {\n  return Boolean(theme && theme.colors && theme.colors.modes)\n}\n\nfunction checkHasCustomPropertiesEnabled(theme: ITheme | null): boolean {\n  return Boolean(\n    theme &&\n      (theme.useCustomProperties === undefined || theme.useCustomProperties),\n  )\n}\n\nfunction checkHasMediaQueryEnabled(theme: ITheme | null): boolean {\n  return Boolean(\n    theme &&\n      (theme.useColorSchemeMediaQuery === undefined ||\n        theme.useColorSchemeMediaQuery),\n  )\n}\n\nfunction getInitialColorModeName(theme: ITheme): string {\n  return theme.initialColorModeName || 'default'\n}\n\nfunction getDefaultColorModeName(theme: ITheme): string {\n  return theme.defaultColorModeName || getInitialColorModeName(theme)\n}\n\nfunction getUsedColorKeys(modes: Record<string, Record<string, Color>>) {\n  let keys: string[] = []\n  for (const key in modes) {\n    keys = [...keys, ...Object.keys(modes[key])]\n  }\n  return keys\n}\n\nexport function createColorStyles(\n  theme: ITheme,\n  { targetSelector = 'body' } = {},\n): string | null {\n  if (!checkHasColorModes(theme)) return null\n\n  const { modes, ...colors } = theme.colors\n  const colorKeys = getUsedColorKeys(modes)\n\n  let styles = toCustomPropertiesDeclarations(\n    colors,\n    theme,\n    colorKeys,\n    XSTYLED_COLORS_PREFIX,\n  )\n\n  function getModePropertiesDeclarations(mode: string) {\n    const modeTheme = getModeTheme(theme as IColorModeTheme, mode)\n    const { modes, ...colors } = modeTheme.colors\n    return toCustomPropertiesDeclarations(\n      { ...colors, ...modes[mode] },\n      modeTheme,\n      colorKeys,\n      XSTYLED_COLORS_PREFIX,\n    )\n  }\n\n  if (theme.useColorSchemeMediaQuery !== false) {\n    SYSTEM_MODES.forEach((mode) => {\n      if (modes[mode]) {\n        const mediaQuery = getMediaQuery(getColorModeQuery(mode))\n        styles += `${mediaQuery}{${getModePropertiesDeclarations(mode)}}`\n      }\n    })\n  }\n\n  const initialModeName = getInitialColorModeName(theme)\n  ;[initialModeName, ...Object.keys(modes)].forEach((mode) => {\n    const key = `&.${getColorModeClassName(mode)}`\n    styles += `${key}{${getModePropertiesDeclarations(mode)}}`\n  })\n\n  return `${targetSelector}{${styles}}`\n}\n\nfunction getSystemModeMql(mode: string) {\n  if (typeof window === 'undefined' || window.matchMedia === undefined) {\n    return null\n  }\n  const query = getColorModeQuery(mode)\n  return window.matchMedia(query)\n}\n\nfunction useSystemMode(theme: ITheme) {\n  const configs: { mode: string; mql: MediaQueryList }[] = React.useMemo(() => {\n    if (!checkHasMediaQueryEnabled(theme)) return []\n    return SYSTEM_MODES.map((mode) => {\n      if (!checkHasColorModes(theme)) return null\n      if (!theme.colors.modes[mode]) return null\n      const mql = getSystemModeMql(mode)\n      return mql ? { mode, mql } : null\n    }).filter(Boolean) as { mode: string; mql: MediaQueryList }[]\n  }, [theme])\n\n  const [systemMode, setSystemMode] = React.useState(() => {\n    const config = configs.find((config) => config.mql.matches)\n    return config ? config.mode : null\n  })\n\n  React.useEffect(() => {\n    const cleans = configs.map(({ mode, mql }) => {\n      const handler = ({ matches }: MediaQueryListEvent) => {\n        if (matches) {\n          setSystemMode(mode)\n        } else {\n          setSystemMode((previousMode) => (previousMode === mode ? null : mode))\n        }\n      }\n      mql.addEventListener('change', handler)\n      return () => mql.removeEventListener('change', handler)\n    })\n    return () => cleans.forEach((clean) => clean())\n  })\n\n  return systemMode\n}\n\nconst useIsomorphicLayoutEffect =\n  typeof window !== 'undefined' ? React.useLayoutEffect : React.useEffect\n\nexport function useColorModeState(\n  theme: ITheme,\n  { target }: { target?: Element } = {},\n): ColorModeState {\n  const systemMode = useSystemMode(theme)\n  const defaultColorMode = getDefaultColorModeName(theme)\n  const initialColorMode = getInitialColorModeName(theme)\n  const [mode, setMode] = React.useState(() => {\n    if (!checkHasColorModes(theme)) return null\n    return defaultColorMode\n  })\n\n  // Add mode className\n  const customPropertiesEnabled = checkHasCustomPropertiesEnabled(theme)\n\n  const manualSetRef = React.useRef(false)\n  const manuallySetMode = React.useCallback((value) => {\n    manualSetRef.current = true\n    setMode(value)\n  }, [])\n\n  // Set initial color mode in lazy\n  useIsomorphicLayoutEffect(() => {\n    if (!checkHasColorModes(theme)) return\n    const storedMode = storage.get()\n    const initialMode = storedMode || systemMode || defaultColorMode\n    if (mode !== initialMode) {\n      setMode(storedMode || systemMode || defaultColorMode)\n    }\n  }, [])\n\n  // Store mode preference\n  useIsomorphicLayoutEffect(() => {\n    if (manualSetRef.current) {\n      if (mode) {\n        storage.set(mode)\n      } else {\n        storage.clear()\n      }\n    }\n  }, [mode])\n\n  // Sync system mode\n  useIsomorphicLayoutEffect(() => {\n    const storedMode = storage.get()\n    if (storedMode) return\n    const targetMode = systemMode || defaultColorMode\n    if (targetMode === mode) return\n    setMode(targetMode)\n  }, [mode, systemMode, defaultColorMode])\n\n  // Add and remove class names\n  useIsomorphicLayoutEffect(() => {\n    if (!mode) return undefined\n    if (!customPropertiesEnabled) return undefined\n    const stored = storage.get()\n    const initial = initialColorMode !== mode\n    if (!stored && !initial) return undefined\n    const className = getColorModeClassName(mode)\n    const usedTarget = target || document.body\n    usedTarget.classList.add(className)\n    return () => {\n      usedTarget.classList.remove(className)\n    }\n  }, [customPropertiesEnabled, target, mode, initialColorMode])\n\n  return [mode, manuallySetMode]\n}\n\nexport function useColorModeTheme(\n  theme: ITheme,\n  mode: string | null,\n): ITheme | null {\n  const [initialMode] = React.useState(mode)\n  const customPropertiesTheme = React.useMemo(() => {\n    if (!initialMode) return null\n    if (!checkHasCustomPropertiesEnabled(theme)) return null\n    if (!checkHasColorModes(theme)) return theme\n    const { modes, ...colors } = theme.colors\n    const colorKeys = getUsedColorKeys(modes)\n\n    return {\n      ...theme,\n      colors: {\n        ...colors,\n        ...toCustomPropertiesReferences(\n          colors,\n          theme,\n          colorKeys,\n          XSTYLED_COLORS_PREFIX,\n        ),\n        modes,\n      },\n      __rawColors: theme.colors,\n    }\n  }, [initialMode, theme])\n\n  const swapModeTheme = React.useMemo(() => {\n    if (!mode) return null\n    if (checkHasCustomPropertiesEnabled(theme)) return null\n    if (!checkHasColorModes(theme)) return theme\n\n    if (mode === getInitialColorModeName(theme)) {\n      return { ...theme, __colorMode: mode }\n    }\n\n    return {\n      ...theme,\n      colors: {\n        ...theme.colors,\n        ...theme.colors.modes[mode],\n      },\n      __colorMode: mode,\n      __rawColors: theme.colors,\n    }\n  }, [theme, mode])\n\n  return (customPropertiesTheme || swapModeTheme) as ITheme\n}\n\nexport const ColorModeContext = React.createContext<ColorModeState | null>(null)\n\nexport function useColorMode(): ColorModeState {\n  const colorModeState = React.useContext(ColorModeContext)\n\n  if (!colorModeState) {\n    throw new Error(`[useColorMode] requires the ColorModeProvider component`)\n  }\n\n  return colorModeState\n}\n\nexport interface ColorModeProviderProps {\n  children: React.ReactNode\n  target?: Element\n  targetSelector?: string\n}\n\nexport function createColorModeProvider({\n  ThemeContext,\n  ThemeProvider,\n  ColorModeStyle,\n}: {\n  ThemeContext: React.Context<any>\n  ThemeProvider: React.ComponentType<any>\n  ColorModeStyle: React.ComponentType<any>\n}): React.FC<ColorModeProviderProps> {\n  function ColorModeProvider({\n    children,\n    target,\n    targetSelector,\n  }: ColorModeProviderProps) {\n    const theme = React.useContext(ThemeContext)\n    if (!theme) {\n      throw new Error(\n        '[ColorModeProvider] requires ThemeProvider upper in the tree',\n      )\n    }\n    const colorState = useColorModeState(theme, { target })\n    const colorModeTheme = useColorModeTheme(theme, colorState[0])\n    return (\n      <>\n        <ColorModeStyle targetSelector={targetSelector} />\n        <ThemeProvider theme={colorModeTheme}>\n          <ColorModeContext.Provider value={colorState}>\n            {children}\n          </ColorModeContext.Provider>\n        </ThemeProvider>\n      </>\n    )\n  }\n  return ColorModeProvider\n}\n\ninterface GetInitScriptOptions {\n  target?: string\n}\n\nfunction getInitScript({\n  target = 'document.body',\n}: GetInitScriptOptions = {}) {\n  return `(function() { try {\n    var mode = localStorage.getItem('${STORAGE_KEY}');\n    if (mode) ${target}.classList.add('${COLOR_MODE_CLASS_PREFIX}' + mode);\n  } catch (e) {} })();`\n}\n\nexport function getColorModeInitScriptElement(\n  options?: GetInitScriptOptions,\n): JSX.Element {\n  return (\n    <script\n      key=\"xstyled-color-mode-init\"\n      dangerouslySetInnerHTML={{ __html: getInitScript(options) }}\n    />\n  )\n}\n\nexport function getColorModeInitScriptTag(\n  options?: GetInitScriptOptions,\n): string {\n  return `<script>${getInitScript(options)}</script>`\n}\n"],"names":["useThemeBreakpoints","theme","getBreakpoints","useThemeMinValue","key","breakpoints","value","useThemeMaxValue","breakPoint","useViewportWidth","React","window","innerWidth","width","setWidth","handleResize","addEventListener","removeEventListener","useThemeBreakpoint","Object","keys","reverse","find","breakpoint","useThemeUp","useThemeDown","createBox","system","meta","getNumber","transform","num","Number","isNaN","SPACES","getMultiDimensions","values","split","p","map","join","COMMA","getMultiValues","getNumberInset","getInset","getNumberSpace","getSpace","getMultiNumberSpace","getNumberBorder","getBorder","getNumberBorderWidth","getBorderWidth","getMultiNumberBorderWidth","getNumberSize","getSize","getMultiBorderStyle","getBorderStyle","propGetters","margin","padding","gap","color","getColor","fill","stroke","getRadius","border","getShadow","height","getZIndex","getFont","getFontSize","getLineHeight","getFontWeight","getLetterSpacing","transition","getTransition","getDuration","animation","getAnimation","top","right","bottom","left","getTimingFunction","getTransform","getTransitionProperty","getMediaWidth","getBreakpointBound","props","v","mediaGetters","getBreakpointMin","getBreakpointMax","PROP_CHAR","VALUE_CHAR","PROP_PATT","MEDIA_CHAR","MEDIA_PATT","MATCH_REGEXP","RegExp","rawValue","matches","lastIndex","prop","colon","imp","semi","media","query","brace","push","slice","index","mediaTransform","forEach","length","getter","exec","QUERY_REGEXP","open","close","args","filter","Boolean","toVarName","replace","toVarValue","toProp","toCustomPropertiesReferences","parent","next","Array","isArray","i","name","obj","string","func","cascade","toCustomPropertiesDeclarations","state","STORAGE_KEY","isLocalStorageAvailable","localStorage","setItem","removeItem","err","storage","get","getItem","set","clear","COLOR_MODE_CLASS_PREFIX","getColorModeClassName","mode","XSTYLED_COLORS_PREFIX","SYSTEM_MODES","getModeTheme","colors","modes","getMediaQuery","getColorModeQuery","checkHasColorModes","checkHasCustomPropertiesEnabled","useCustomProperties","undefined","checkHasMediaQueryEnabled","useColorSchemeMediaQuery","getInitialColorModeName","initialColorModeName","getDefaultColorModeName","defaultColorModeName","getUsedColorKeys","createColorStyles","targetSelector","colorKeys","styles","getModePropertiesDeclarations","modeTheme","mediaQuery","initialModeName","getSystemModeMql","matchMedia","useSystemMode","configs","mql","config","systemMode","setSystemMode","cleans","handler","previousMode","clean","useIsomorphicLayoutEffect","useColorModeState","target","defaultColorMode","initialColorMode","setMode","customPropertiesEnabled","manualSetRef","manuallySetMode","current","storedMode","initialMode","targetMode","stored","initial","className","usedTarget","document","body","classList","add","remove","useColorModeTheme","customPropertiesTheme","__rawColors","swapModeTheme","__colorMode","ColorModeContext","useColorMode","colorModeState","Error","createColorModeProvider","ThemeContext","ThemeProvider","ColorModeStyle","ColorModeProvider","children","colorState","colorModeTheme","Provider","getInitScript","getColorModeInitScriptElement","options","dangerouslySetInnerHTML","__html","getColorModeInitScriptTag"],"mappings":";;;;;;;;AAAA;SAIgBA,oBAAoBC;AAClC,SAAOC,qBAAc,CAAC;AAAED,IAAAA,KAAK,EAALA;AAAF,GAAD,CAArB;AACD;AAED;;;;;AAIA,SAASE,gBAAT,CAA0BF,KAA1B,EAAwCG,GAAxC;AACE,MAAMC,WAAW,GAAGL,mBAAmB,CAACC,KAAD,CAAvC;AACA,MAAMK,KAAK,GAAGD,WAAW,CAACD,GAAD,CAAzB;AACA,SAAOE,KAAK,KAAK,CAAV,GAAc,IAAd,GAAqBA,KAA5B;AACD;AAED;;;;;;;;;;AAQA,SAASC,gBAAT,CAA0BN,KAA1B,EAAwCG,GAAxC;AACE,MAAMC,WAAW,GAAGL,mBAAmB,CAACC,KAAD,CAAvC;AACA,MAAMO,UAAU,GAAGH,WAAW,CAACD,GAAD,CAA9B;AACA,SAAOI,UAAU,KAAK,CAAf,GAAmB,IAAnB,GAA0BA,UAAU,GAAG,IAA9C;AACD;;SAEeC;wBACYC,cAAA,CACxB,OAAOC,MAAP,KAAkB,WAAlB,GAAgC,IAAhC,GAAuCA,MAAM,CAACC,UADtB;MAAnBC;MAAOC;;AAIdJ,EAAAA,eAAA,CAAgB;AACd,aAASK,YAAT;AACED,MAAAA,QAAQ,CAACH,MAAM,CAACC,UAAR,CAAR;AACD;;;AAGDD,IAAAA,MAAM,CAACK,gBAAP,CAAwB,QAAxB,EAAkCD,YAAlC;AACAD,IAAAA,QAAQ,CAACH,MAAM,CAACC,UAAR,CAAR;AAEA,WAAO;AAAA,aAAMD,MAAM,CAACM,mBAAP,CAA2B,QAA3B,EAAqCF,YAArC,CAAN;AAAA,KAAP;AACD,GAVD,EAUG,EAVH;AAYA,SAAOF,KAAP;AACD;SAEeK,mBAAmBjB;AACjC,MAAMI,WAAW,GAAGL,mBAAmB,CAACC,KAAD,CAAvC;AACA,MAAMY,KAAK,GAAGJ,gBAAgB,EAA9B;AACA,SAAOC,aAAA,CAAc;AACnB,WACES,MAAM,CAACC,IAAP,CAAYf,WAAZ,EACGgB,OADH,GAEGC,IAFH,CAGI,UAACC,UAAD;AAAA,aAAgBV,KAAK,KAAK,IAAV,IAAkBA,KAAK,GAAGR,WAAW,CAACkB,UAAD,CAArD;AAAA,KAHJ,KAIO,IALT;AAOD,GARM,EAQJ,CAAClB,WAAD,EAAcQ,KAAd,CARI,CAAP;AASD;SAEeW,WAAWvB,OAAcG;AACvC,MAAME,KAAK,GAAGH,gBAAgB,CAACF,KAAD,EAAQG,GAAR,CAA9B;AACA,MAAMS,KAAK,GAAGJ,gBAAgB,EAA9B;AACA,SAAOI,KAAK,KAAK,IAAV,IAAkBP,KAAK,KAAK,IAA5B,IAAoCO,KAAK,IAAIP,KAApD;AACD;SAEemB,aAAaxB,OAAcG;AACzC,MAAME,KAAK,GAAGC,gBAAgB,CAACN,KAAD,EAAQG,GAAR,CAA9B;AACA,MAAMS,KAAK,GAAGJ,gBAAgB,EAA9B;AACA,SAAOI,KAAK,KAAK,IAAV,IAAkBP,KAAK,KAAK,IAA5B,IAAoCO,KAAK,GAAGP,KAAnD;AACD;;SC1EeoB;AACd,SAAO,QAAQC,aAAR,MAAP;AACD;AACDD,SAAS,CAACE,IAAV,GAAiBD,aAAM,CAACC,IAAxB;;ACmBA,IAAMC,SAAS,GAAG,SAAZA,SAAY,CAACC,SAAD;AAAA,SAAyB,UAACxB,KAAD;AACzC,QAAMyB,GAAG,GAAGC,MAAM,CAAC1B,KAAD,CAAlB;AACA,WAAOwB,SAAS,CAACE,MAAM,CAACC,KAAP,CAAaF,GAAb,IAAoBzB,KAApB,GAA4ByB,GAA7B,CAAhB;AACD,GAHiB;AAAA,CAAlB;;AAKA,IAAMG,MAAM,GAAG,KAAf;;AACA,IAAMC,kBAAkB,GAAG,SAArBA,kBAAqB,CAACL,SAAD;AAAA,SAAyB,UAACxB,KAAD;AAClD,QAAM8B,MAAM,GAAG9B,KAAK,CAAC+B,KAAN,CAAYH,MAAZ,CAAf;AACA,WAAO,UAACI,CAAD;AAAA,aACLF,MAAM,CAACG,GAAP,CAAW,UAACjC,KAAD;AAAA,eAAgBwB,SAAS,CAACxB,KAAD,CAAT,CAAiBgC,CAAjB,CAAhB;AAAA,OAAX,EAAgDE,IAAhD,CAAqD,GAArD,CADK;AAAA,KAAP;AAED,GAJ0B;AAAA,CAA3B;;AAMA,IAAMC,KAAK,GAAG,SAAd;;AACA,IAAMC,cAAc,GAAG,SAAjBA,cAAiB,CAACZ,SAAD;AAAA,SAAyB,UAACxB,KAAD;AAC9C,QAAM8B,MAAM,GAAG9B,KAAK,CAAC+B,KAAN,CAAYI,KAAZ,CAAf;AACA,WAAO,UAACH,CAAD;AAAA,aACLF,MAAM,CAACG,GAAP,CAAW,UAACjC,KAAD;AAAA,eAAgBwB,SAAS,CAACxB,KAAD,CAAT,CAAiBgC,CAAjB,CAAhB;AAAA,OAAX,EAAgDE,IAAhD,CAAqD,GAArD,CADK;AAAA,KAAP;AAED,GAJsB;AAAA,CAAvB;;AAMA,IAAMG,cAAc,gBAAGd,SAAS,CAACe,eAAD,CAAhC;AAEA,IAAMC,cAAc,gBAAGhB,SAAS,CAACiB,eAAD,CAAhC;AACA,IAAMC,mBAAmB,gBAAGZ,kBAAkB,CAACU,cAAD,CAA9C;AAEA,IAAMG,eAAe,gBAAGnB,SAAS,CAACoB,gBAAD,CAAjC;AAEA,IAAMC,oBAAoB,gBAAGrB,SAAS,CAACsB,qBAAD,CAAtC;AACA,IAAMC,yBAAyB,gBAAGjB,kBAAkB,CAACe,oBAAD,CAApD;AAEA,IAAMG,aAAa,gBAAGxB,SAAS,CAACyB,cAAD,CAA/B;AAEA,IAAMC,mBAAmB,gBAAGpB,kBAAkB,CAACqB,qBAAD,CAA9C;AAEA,IAAaC,WAAW,GAAG;AACzB;AACAC,EAAAA,MAAM,EAAEX,mBAFiB;AAGzB,gBAAcF,cAHW;AAIzB,mBAAiBA,cAJQ;AAKzB,iBAAeA,cALU;AAMzB,kBAAgBA,cANS;AAOzBc,EAAAA,OAAO,EAAEZ,mBAPgB;AAQzB,iBAAeF,cARU;AASzB,oBAAkBA,cATO;AAUzB,kBAAgBA,cAVS;AAWzB,mBAAiBA,cAXQ;AAYzBe,EAAAA,GAAG,EAAEb,mBAZoB;AAazB,cAAYA,mBAba;AAczB,aAAWF,cAdc;AAezB,kBAAgBA,cAfS;AAgBzB,gBAAcA,cAhBW;AAiBzB,qBAAmBA,cAjBM;AAmBzB;AACAgB,EAAAA,KAAK,EAAEC,eApBkB;AAqBzB,sBAAoBA,eArBK;AAsBzB,kBAAgBA,eAtBS;AAuBzB,sBAAoBA,eAvBK;AAwBzB,wBAAsBA,eAxBG;AAyBzB,yBAAuBA,eAzBE;AA0BzB,uBAAqBA,eA1BI;AA2BzB,mBAAiBA,eA3BQ;AA4BzBC,EAAAA,IAAI,EAAED,eA5BmB;AA6BzBE,EAAAA,MAAM,EAAEF,eA7BiB;AA+BzB;AACA,gCAAiB3B,kBAAkB,eAACN,SAAS,CAACoC,gBAAD,CAAV,CAhCV;AAiCzB,yCAA0B9B,kBAAkB,eAACN,SAAS,CAACoC,gBAAD,CAAV,CAjCnB;AAkCzB,0CAA2B9B,kBAAkB,eAACN,SAAS,CAACoC,gBAAD,CAAV,CAlCpB;AAmCzB,6CAA8B9B,kBAAkB,eAACN,SAAS,CAACoC,gBAAD,CAAV,CAnCvB;AAoCzB,4CAA6B9B,kBAAkB,eAACN,SAAS,CAACoC,gBAAD,CAAV,CApCtB;AAsCzB;AACAC,EAAAA,MAAM,EAAElB,eAvCiB;AAwCzB,gBAAcA,eAxCW;AAyCzB,kBAAgBA,eAzCS;AA0CzB,mBAAiBA,eA1CQ;AA2CzB,iBAAeA,eA3CU;AA6CzB;AACA,kBAAgBI,yBA9CS;AA+CzB,sBAAoBF,oBA/CK;AAgDzB,wBAAsBA,oBAhDG;AAiDzB,yBAAuBA,oBAjDE;AAkDzB,uBAAqBA,oBAlDI;AAmDzB,mBAAiBA,oBAnDQ;AAqDzB;AACA,kBAAgBK,mBAtDS;AAuDzB,sBAAoBC,qBAvDK;AAwDzB,wBAAsBA,qBAxDG;AAyDzB,yBAAuBA,qBAzDE;AA0DzB,uBAAqBA,qBA1DI;AA2DzB,mBAAiBA,qBA3DQ;AA6DzB;AACA,6BAAcd,cAAc,CAACyB,gBAAD,CA9DH;AA+DzB,8BAAezB,cAAc,CAACyB,gBAAD,CA/DJ;AAiEzB;AACAtD,EAAAA,KAAK,EAAEwC,aAlEkB;AAmEzBe,EAAAA,MAAM,EAAEf,aAnEiB;AAoEzB,eAAaA,aApEY;AAqEzB,gBAAcA,aArEW;AAsEzB,eAAaA,aAtEY;AAuEzB,gBAAcA,aAvEW;AAwEzB,4BAAaX,cAAc,CAACW,aAAD,CAxEF;AA0EzB;AACA,0BAAWxB,SAAS,CAACwC,gBAAD,CA3EK;AA6EzB;AACA,iBAAeC,cA9EU;AAgFzB;AACA,4BAAazC,SAAS,CAAC0C,kBAAD,CAjFG;AAmFzB;AACA,8BAAe1C,SAAS,CAAC2C,oBAAD,CApFC;AAsFzB;AACA,iBAAeC,oBAvFU;AAyFzB;AACA,iCAAkB5C,SAAS,CAAC6C,uBAAD,CA1FF;AA4FzB;AACAC,EAAAA,UAAU,EAAEC,oBA7Fa;AA+FzB;AACA,yBAAuBC,kBAhGE;AAiGzB,wBAAsBA,kBAjGG;AAmGzB;AACAC,EAAAA,SAAS,EAAEC,mBApGc;AAsGzB;AACAC,EAAAA,GAAG,EAAErC,cAvGoB;AAwGzBsC,EAAAA,KAAK,EAAEtC,cAxGkB;AAyGzBuC,EAAAA,MAAM,EAAEvC,cAzGiB;AA0GzBwC,EAAAA,IAAI,EAAExC,cA1GmB;AA4GzB;AACA,+BAA6ByC,wBA7GJ;AA8GzB,gCAA8BA,wBA9GL;AAgHzB;AACAtD,EAAAA,SAAS,EAAEuD,mBAjHc;AAmHzB;AACA,yBAAuBC;AApHE,CAApB;;ACnDP,IAAMC,aAAa,GAAG,SAAhBA,aAAgB,CAACC,kBAAD;AAAA,SAAkC,UAAClF,KAAD;AAAA,WAAgB,UACtEmF,KADsE;AAGtE,UAAMC,CAAC,GAAGF,kBAAkB,CAACtF,qBAAc,CAACuF,KAAD,CAAf,EAAwBnF,KAAxB,CAA5B;AAEA;AACA;;AACA,aAAOoF,CAAC,KAAK,IAAN,GAAa,GAAb,GAAmBA,CAAC,IAAIpF,KAA/B;AACD,KARuD;AAAA,GAAlC;AAAA,CAAtB;;AAUA,AAAO,IAAMqF,YAAY,GAAG;AAC1B,4BAAaJ,aAAa,CAACK,uBAAD,CADA;AAE1B,4BAAaL,aAAa,CAACM,uBAAD;AAFA,CAArB;;AChBP;AACA;AAIA,IAAMC,SAAS,WAAf;AAGA;;AACA,IAAMC,UAAU,gCAAhB;;AAGA,IAAMC,SAAS,GACb,MAAIF,SAAJ;AAAA;AAAA;AAAA,MAGIC,UAHJ;AAAA;AAAA,SADa;AAAf;;AAUA,IAAME,UAAU,SAAhB;;AAGA,IAAMC,UAAU,GACd;AAAA;AAAA,MAEID,UAFJ;AAAA,WADc;AAAhB;AAOA,IAAME,YAAY,gBAAG,IAAIC,MAAJ,SAAiBJ,SAAjB,SAA8BE,UAA9B,YAArB;AAEA,SAAgBpE,UAAUuE;AACxB,MAAI,OAAOA,QAAP,KAAoB,QAAxB,EAAkC,OAAOA,QAAP;AAClC,MAAIC,OAAJ;AACA,MAAIC,SAAS,GAAG,CAAhB;AACA,MAAMnE,MAAM,GAAG,EAAf;;;mBAEiEkE;QAAtDE;QAAMC;QAAOnG;QAAOoG;QAAKC;QAAMC;QAAOC;QAAOC;;AACtD,QAAIF,KAAJ,EAAW;AACTxE,MAAAA,MAAM,CAAC2E,IAAP,CAAYV,QAAQ,CAACW,KAAT,CAAeT,SAAf,EAA0BD,OAAO,CAACW,KAAlC,CAAZ;AACA7E,MAAAA,MAAM,CAAC2E,IAAP,CAAYH,KAAZ;AACAM,MAAAA,cAAc,CAACL,KAAD,CAAd,CAAsBM,OAAtB,CAA8B,UAACzB,CAAD;AAAA,eAAOtD,MAAM,CAAC2E,IAAP,CAAYrB,CAAZ,CAAP;AAAA,OAA9B;AACAtD,MAAAA,MAAM,CAAC2E,IAAP,CAAYD,KAAZ;AACAP,MAAAA,SAAS,GAAGD,OAAO,CAACW,KAAR,GAAgBX,OAAO,CAAC,CAAD,CAAP,CAAWc,MAAvC;AACD,KAND,MAMO;AACL,UAAMC,MAAM,GAAI5D,WAAmB,CAAC+C,IAAD,CAAnC;;AACA,UAAIa,MAAJ,EAAY;AACVjF,QAAAA,MAAM,CAAC2E,IAAP,CAAYV,QAAQ,CAACW,KAAT,CAAeT,SAAf,EAA0BD,OAAO,CAACW,KAAlC,CAAZ;AACA7E,QAAAA,MAAM,CAAC2E,IAAP,CACE,UAACzE,CAAD;AAAA,sBACKkE,IADL,GACYC,KADZ,GACoBY,MAAM,CAAC/G,KAAD,CAAN,CAAcgC,CAAd,CADpB,IACuCoE,GAAG,IAAI,EAD9C,IACmDC,IADnD;AAAA,SADF;AAIAJ,QAAAA,SAAS,GAAGD,OAAO,CAACW,KAAR,GAAgBX,OAAO,CAAC,CAAD,CAAP,CAAWc,MAAvC;AACD;AACF;;;AAlBH,SAAQd,OAAO,GAAGH,YAAY,CAACmB,IAAb,CAAkBjB,QAAlB,CAAlB,EAAgD;AAAA;AAmB/C;;AACDjE,EAAAA,MAAM,CAAC2E,IAAP,CAAYV,QAAQ,CAACW,KAAT,CAAeT,SAAf,EAA0BF,QAAQ,CAACe,MAAnC,CAAZ;AACA,SAAOhF,MAAP;AACD;AAGD;;AACA,IAAMmF,YAAY,gBAAG,IAAInB,MAAJ,CACnB;AAAA,MACIN,SADJ;AAAA;AAAA;AAAA,WADmB;AAAA,IAArB;;AASA,SAASoB,cAAT,CAAwBb,QAAxB;AACE,MAAIC,OAAJ;AACA,MAAIC,SAAS,GAAG,CAAhB;AACA,MAAMnE,MAAM,GAAG,EAAf;;;oBAE8CkE;QAAnCkB;QAAMhB;QAAMC;QAAOnG;QAAOmH;AACnC,QAAMJ,MAAM,GAAI1B,YAAoB,CAACa,IAAD,CAApC;;AACA,QAAIa,MAAJ,EAAY;AACVjF,MAAAA,MAAM,CAAC2E,IAAP,CAAYV,QAAQ,CAACW,KAAT,CAAeT,SAAf,EAA0BD,OAAO,CAACW,KAAlC,CAAZ;AACA7E,MAAAA,MAAM,CAAC2E,IAAP,CACE,UAACzE,CAAD;AAAA,oBAAkBkF,IAAlB,GAAyBhB,IAAzB,GAAgCC,KAAhC,GAAwCY,MAAM,CAAC/G,KAAD,CAAN,CAAcgC,CAAd,CAAxC,GAA2DmF,KAA3D;AAAA,OADF;AAGAlB,MAAAA,SAAS,GAAGD,OAAO,CAACW,KAAR,GAAgBX,OAAO,CAAC,CAAD,CAAP,CAAWc,MAAvC;AACD;;;AATH,SAAQd,OAAO,GAAGiB,YAAY,CAACD,IAAb,CAAkBjB,QAAlB,CAAlB,EAAgD;AAAA;AAU/C;;AACDjE,EAAAA,MAAM,CAAC2E,IAAP,CAAYV,QAAQ,CAACW,KAAT,CAAeT,SAAf,EAA0BF,QAAQ,CAACe,MAAnC,CAAZ;AACA,SAAOhF,MAAP;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACzFD,IAAMI,IAAI,GAAG,SAAPA,IAAO;AAAA,oCAAIkF,IAAJ;AAAIA,IAAAA,IAAJ;AAAA;;AAAA,SACXA,IAAI,CAACC,MAAL,CAAYC,OAAZ,EAAqBpF,IAArB,CAA0B,GAA1B,CADW;AAAA,CAAb;;AAGA,IAAMqF,SAAS,GAAG,SAAZA,SAAY,CAACzH,GAAD;AAAA,gBAA8BA,GAAG,CAAC0H,OAAJ,CAAY,KAAZ,EAAmB,GAAnB,CAA9B;AAAA,CAAlB;;AACA,IAAMC,UAAU,GAAG,SAAbA,UAAa,CAAC3H,GAAD,EAAcE,KAAd;AAAA,kBACVuH,SAAS,CAACzH,GAAD,CADC,UACSE,KADT;AAAA,CAAnB;;AAEA,IAAM0H,MAAM,GAAG,SAATA,MAAS,CAAC5H,GAAD,EAAcE,KAAd;AAAA,SAA2CF,GAA3C,UAAmDE,KAAnD;AAAA,CAAf;;AAEA,SAAgB2H,6BAGd7F,QACAnC,OACAmB,MACA8G;MADA9G;AAAAA,IAAAA,OAAiBD,MAAM,CAACC,IAAP,CAAYgB,MAAZ;;;AAGjB,MAAM+F,IAAI,GAAqCC,KAAK,CAACC,OAAN,CAAcjG,MAAd,IAC1C,EAD0C,GAE1C,EAFL;;AAIA,OAAK,IAAMkG,CAAX,IAAgBlH,IAAhB,EAAsB;AACpB,QAAMhB,GAAG,GAAGgB,IAAI,CAACkH,CAAD,CAAhB;AACA,QAAMhI,KAAK,GAAG8B,MAAM,CAAChC,GAAD,CAApB;AACA,QAAMmI,IAAI,GAAG/F,IAAI,CAAC0F,MAAD,EAAS9H,GAAT,CAAjB;;AACA,QAAIoI,QAAG,CAAClI,KAAD,CAAP,EAAgB;AACd6H,MAAAA,IAAI,CAAC/H,GAAD,CAAJ,GAAY6H,4BAA4B,CACtC3H,KADsC,EAEtCL,KAFsC,EAGtCkB,MAAM,CAACC,IAAP,CAAYd,KAAZ,CAHsC,EAItCiI,IAJsC,CAAxC;AAMA;AACD;;AACD,QAAIE,WAAM,CAACnI,KAAD,CAAV,EAAmB;AACjB6H,MAAAA,IAAI,CAAC/H,GAAD,CAAJ,GAAY2H,UAAU,CAACQ,IAAD,EAAOjI,KAAP,CAAtB;AACA;AACD;;AACD,QAAIoI,SAAI,CAACpI,KAAD,CAAR,EAAiB;AACf6H,MAAAA,IAAI,CAAC/H,GAAD,CAAJ,GAAY2H,UAAU,CAACQ,IAAD,EAAOI,YAAO,CAACrI,KAAD,EAAQ;AAAEL,QAAAA,KAAK,EAALA;AAAF,OAAR,CAAd,CAAtB;AACA;AACD;AACF;;AAED,SAAOkI,IAAP;AACD;AAED,SAAgBS,+BACdxG,QACAnC,OACAmB,MACA8G,QACAW;MAFAzH;AAAAA,IAAAA,OAAiBD,MAAM,CAACC,IAAP,CAAYgB,MAAZ;;;MAEjByG;AAAAA,IAAAA,QAAQ;AAAEvI,MAAAA,KAAK,EAAE;AAAT;;;AAER,OAAK,IAAMgI,CAAX,IAAgBlH,IAAhB,EAAsB;AACpB,QAAMhB,GAAG,GAAGgB,IAAI,CAACkH,CAAD,CAAhB;AACA,QAAMhI,KAAK,GAAG8B,MAAM,CAAChC,GAAD,CAApB;AACA,QAAMmI,IAAI,GAAG/F,IAAI,CAAC0F,MAAD,EAAS9H,GAAT,CAAjB;;AACA,QAAIoI,QAAG,CAAClI,KAAD,CAAP,EAAgB;AACdsI,MAAAA,8BAA8B,CAC5BtI,KAD4B,EAE5BL,KAF4B,EAG5BkB,MAAM,CAACC,IAAP,CAAYd,KAAZ,CAH4B,EAI5BiI,IAJ4B,EAK5BM,KAL4B,CAA9B;AAOA;AACD;;AACD,QAAIJ,WAAM,CAACnI,KAAD,CAAV,EAAmB;AACjBuI,MAAAA,KAAK,CAACvI,KAAN,IAAe0H,MAAM,CAACH,SAAS,CAACU,IAAD,CAAV,EAAkBjI,KAAlB,CAArB;AACA;AACD;;AACD,QAAIoI,SAAI,CAACpI,KAAD,CAAR,EAAiB;AACfuI,MAAAA,KAAK,CAACvI,KAAN,IAAe0H,MAAM,CAACH,SAAS,CAACU,IAAD,CAAV,EAAkBI,YAAO,CAACrI,KAAD,EAAQ;AAAEL,QAAAA,KAAK,EAALA;AAAF,OAAR,CAAzB,CAArB;AACA;AACD;AACF;;AAED,SAAO4I,KAAK,CAACvI,KAAb;AACD;;ACrDD,IAAMwI,WAAW,GAAG,oBAApB;;AAEA,IAAMC,uBAAuB,GAC3B,OAAOpI,MAAP,KAAkB,WAAlB,iBACC;AACC,MAAI;AACF,QAAMP,GAAG,GAAG,kBAAZ;AACAO,IAAAA,MAAM,CAACqI,YAAP,CAAoBC,OAApB,CAA4B7I,GAA5B,EAAiCA,GAAjC;AACAO,IAAAA,MAAM,CAACqI,YAAP,CAAoBE,UAApB,CAA+B9I,GAA/B;AACA,WAAO,IAAP;AACD,GALD,CAKE,OAAO+I,GAAP,EAAY;AACZ,WAAO,KAAP;AACD;AACF,CATD,EAFF;;AAmBA,IAAMC,OAAO,GAAYL,uBAAuB,GAC5C;AACEM,EAAAA,GAAG,EAAE;AAAA,WAAM1I,MAAM,CAACqI,YAAP,CAAoBM,OAApB,CAA4BR,WAA5B,CAAN;AAAA,GADP;AAEES,EAAAA,GAAG,EAAE,aAACjJ,KAAD;AACHK,IAAAA,MAAM,CAACqI,YAAP,CAAoBC,OAApB,CAA4BH,WAA5B,EAAyCxI,KAAzC;AACD,GAJH;AAKEkJ,EAAAA,KAAK,EAAE;AAAA,WAAM7I,MAAM,CAACqI,YAAP,CAAoBE,UAApB,CAA+BJ,WAA/B,CAAN;AAAA;AALT,CAD4C,GAQ5C;AACEO,EAAAA,GAAG,EAAE;AAAA,WAAM,IAAN;AAAA,GADP;AAEEE,EAAAA,GAAG,EAAE,iBAFP;AAGEC,EAAAA,KAAK,EAAE;AAHT,CARJ;AAcA,IAAMC,uBAAuB,GAAG,qBAAhC;;AACA,IAAMC,qBAAqB,GAAG,SAAxBA,qBAAwB,CAACC,IAAD;AAAA,cACzBF,uBADyB,GACCE,IADD;AAAA,CAA9B;;AAGA,IAAMC,qBAAqB,GAAG,gBAA9B;AACA,IAAMC,YAAY,GAAG,CAAC,OAAD,EAAU,MAAV,CAArB;;AAEA,SAASC,YAAT,CAAsB7J,KAAtB,EAA8C0J,IAA9C;AACE,sBACK1J,KADL;AAEE8J,IAAAA,MAAM,eAAO9J,KAAK,CAAC8J,MAAb,EAAwB9J,KAAK,CAAC8J,MAAN,CAAaC,KAAb,CAAmBL,IAAnB,CAAxB;AAFR;AAID;;AAED,IAAMM,aAAa,GAAG,SAAhBA,aAAgB,CAACpD,KAAD;AAAA,qBAAqCA,KAArC;AAAA,CAAtB;;AACA,IAAMqD,iBAAiB,GAAG,SAApBA,iBAAoB,CAACP,IAAD;AAAA,qCACEA,IADF;AAAA,CAA1B;;AAGA,SAASQ,kBAAT,CAA4BlK,KAA5B;AACE,SAAO2H,OAAO,CAAC3H,KAAK,IAAIA,KAAK,CAAC8J,MAAf,IAAyB9J,KAAK,CAAC8J,MAAN,CAAaC,KAAvC,CAAd;AACD;;AAED,SAASI,+BAAT,CAAyCnK,KAAzC;AACE,SAAO2H,OAAO,CACZ3H,KAAK,KACFA,KAAK,CAACoK,mBAAN,KAA8BC,SAA9B,IAA2CrK,KAAK,CAACoK,mBAD/C,CADO,CAAd;AAID;;AAED,SAASE,yBAAT,CAAmCtK,KAAnC;AACE,SAAO2H,OAAO,CACZ3H,KAAK,KACFA,KAAK,CAACuK,wBAAN,KAAmCF,SAAnC,IACCrK,KAAK,CAACuK,wBAFL,CADO,CAAd;AAKD;;AAED,SAASC,uBAAT,CAAiCxK,KAAjC;AACE,SAAOA,KAAK,CAACyK,oBAAN,IAA8B,SAArC;AACD;;AAED,SAASC,uBAAT,CAAiC1K,KAAjC;AACE,SAAOA,KAAK,CAAC2K,oBAAN,IAA8BH,uBAAuB,CAACxK,KAAD,CAA5D;AACD;;AAED,SAAS4K,gBAAT,CAA0Bb,KAA1B;AACE,MAAI5I,IAAI,GAAa,EAArB;;AACA,OAAK,IAAMhB,GAAX,IAAkB4J,KAAlB,EAAyB;AACvB5I,IAAAA,IAAI,aAAOA,IAAP,EAAgBD,MAAM,CAACC,IAAP,CAAY4I,KAAK,CAAC5J,GAAD,CAAjB,CAAhB,CAAJ;AACD;;AACD,SAAOgB,IAAP;AACD;;AAED,SAAgB0J,kBACd7K;gCAC8B;iCAA5B8K;MAAAA,kDAAiB;;AAEnB,MAAI,CAACZ,kBAAkB,CAAClK,KAAD,CAAvB,EAAgC,OAAO,IAAP;;sBAEHA,KAAK,CAAC8J;MAA3BC,sBAAAA;MAAUD;;AAClB,MAAMiB,SAAS,GAAGH,gBAAgB,CAACb,KAAD,CAAlC;AAEA,MAAIiB,MAAM,GAAGrC,8BAA8B,CACzCmB,MADyC,EAEzC9J,KAFyC,EAGzC+K,SAHyC,EAIzCpB,qBAJyC,CAA3C;;AAOA,WAASsB,6BAAT,CAAuCvB,IAAvC;AACE,QAAMwB,SAAS,GAAGrB,YAAY,CAAC7J,KAAD,EAA2B0J,IAA3B,CAA9B;;4BAC6BwB,SAAS,CAACpB;QAA/BC,0BAAAA;QAAUD;;AAClB,WAAOnB,8BAA8B,cAC9BmB,MAD8B,EACnBC,KAAK,CAACL,IAAD,CADc,GAEnCwB,SAFmC,EAGnCH,SAHmC,EAInCpB,qBAJmC,CAArC;AAMD;;AAED,MAAI3J,KAAK,CAACuK,wBAAN,KAAmC,KAAvC,EAA8C;AAC5CX,IAAAA,YAAY,CAAC1C,OAAb,CAAqB,UAACwC,IAAD;AACnB,UAAIK,KAAK,CAACL,IAAD,CAAT,EAAiB;AACf,YAAMyB,UAAU,GAAGnB,aAAa,CAACC,iBAAiB,CAACP,IAAD,CAAlB,CAAhC;AACAsB,QAAAA,MAAM,IAAOG,UAAP,SAAqBF,6BAA6B,CAACvB,IAAD,CAAlD,MAAN;AACD;AACF,KALD;AAMD;;AAED,MAAM0B,eAAe,GAAGZ,uBAAuB,CAACxK,KAAD,CAA/C;AACC,GAACoL,eAAD,SAAqBlK,MAAM,CAACC,IAAP,CAAY4I,KAAZ,CAArB,EAAyC7C,OAAzC,CAAiD,UAACwC,IAAD;AAChD,QAAMvJ,GAAG,UAAQsJ,qBAAqB,CAACC,IAAD,CAAtC;AACAsB,IAAAA,MAAM,IAAO7K,GAAP,SAAc8K,6BAA6B,CAACvB,IAAD,CAA3C,MAAN;AACD,GAHA;AAKD,SAAUoB,cAAV,SAA4BE,MAA5B;AACD;;AAED,SAASK,gBAAT,CAA0B3B,IAA1B;AACE,MAAI,OAAOhJ,MAAP,KAAkB,WAAlB,IAAiCA,MAAM,CAAC4K,UAAP,KAAsBjB,SAA3D,EAAsE;AACpE,WAAO,IAAP;AACD;;AACD,MAAMzD,KAAK,GAAGqD,iBAAiB,CAACP,IAAD,CAA/B;AACA,SAAOhJ,MAAM,CAAC4K,UAAP,CAAkB1E,KAAlB,CAAP;AACD;;AAED,SAAS2E,aAAT,CAAuBvL,KAAvB;AACE,MAAMwL,OAAO,GAA4C/K,aAAA,CAAc;AACrE,QAAI,CAAC6J,yBAAyB,CAACtK,KAAD,CAA9B,EAAuC,OAAO,EAAP;AACvC,WAAO4J,YAAY,CAACtH,GAAb,CAAiB,UAACoH,IAAD;AACtB,UAAI,CAACQ,kBAAkB,CAAClK,KAAD,CAAvB,EAAgC,OAAO,IAAP;AAChC,UAAI,CAACA,KAAK,CAAC8J,MAAN,CAAaC,KAAb,CAAmBL,IAAnB,CAAL,EAA+B,OAAO,IAAP;AAC/B,UAAM+B,GAAG,GAAGJ,gBAAgB,CAAC3B,IAAD,CAA5B;AACA,aAAO+B,GAAG,GAAG;AAAE/B,QAAAA,IAAI,EAAJA,IAAF;AAAQ+B,QAAAA,GAAG,EAAHA;AAAR,OAAH,GAAmB,IAA7B;AACD,KALM,EAKJ/D,MALI,CAKGC,OALH,CAAP;AAMD,GARwD,EAQtD,CAAC3H,KAAD,CARsD,CAAzD;;wBAUoCS,cAAA,CAAe;AACjD,QAAMiL,MAAM,GAAGF,OAAO,CAACnK,IAAR,CAAa,UAACqK,MAAD;AAAA,aAAYA,MAAM,CAACD,GAAP,CAAWpF,OAAvB;AAAA,KAAb,CAAf;AACA,WAAOqF,MAAM,GAAGA,MAAM,CAAChC,IAAV,GAAiB,IAA9B;AACD,GAHmC;MAA7BiC;MAAYC;;AAKnBnL,EAAAA,eAAA,CAAgB;AACd,QAAMoL,MAAM,GAAGL,OAAO,CAAClJ,GAAR,CAAY;UAAGoH,aAAAA;UAAM+B,YAAAA;;AAClC,UAAMK,OAAO,GAAG,SAAVA,OAAU;YAAGzF,gBAAAA;;AACjB,YAAIA,OAAJ,EAAa;AACXuF,UAAAA,aAAa,CAAClC,IAAD,CAAb;AACD,SAFD,MAEO;AACLkC,UAAAA,aAAa,CAAC,UAACG,YAAD;AAAA,mBAAmBA,YAAY,KAAKrC,IAAjB,GAAwB,IAAxB,GAA+BA,IAAlD;AAAA,WAAD,CAAb;AACD;AACF,OAND;;AAOA+B,MAAAA,GAAG,CAAC1K,gBAAJ,CAAqB,QAArB,EAA+B+K,OAA/B;AACA,aAAO;AAAA,eAAML,GAAG,CAACzK,mBAAJ,CAAwB,QAAxB,EAAkC8K,OAAlC,CAAN;AAAA,OAAP;AACD,KAVc,CAAf;AAWA,WAAO;AAAA,aAAMD,MAAM,CAAC3E,OAAP,CAAe,UAAC8E,KAAD;AAAA,eAAWA,KAAK,EAAhB;AAAA,OAAf,CAAN;AAAA,KAAP;AACD,GAbD;AAeA,SAAOL,UAAP;AACD;;AAED,IAAMM,yBAAyB,GAC7B,OAAOvL,MAAP,KAAkB,WAAlB,GAAgCD,qBAAhC,GAAwDA,eAD1D;AAGA,SAAgByL,kBACdlM;kCACmC;MAAjCmM,eAAAA;;AAEF,MAAMR,UAAU,GAAGJ,aAAa,CAACvL,KAAD,CAAhC;AACA,MAAMoM,gBAAgB,GAAG1B,uBAAuB,CAAC1K,KAAD,CAAhD;AACA,MAAMqM,gBAAgB,GAAG7B,uBAAuB,CAACxK,KAAD,CAAhD;;yBACwBS,cAAA,CAAe;AACrC,QAAI,CAACyJ,kBAAkB,CAAClK,KAAD,CAAvB,EAAgC,OAAO,IAAP;AAChC,WAAOoM,gBAAP;AACD,GAHuB;MAAjB1C;MAAM4C;;;AAMb,MAAMC,uBAAuB,GAAGpC,+BAA+B,CAACnK,KAAD,CAA/D;AAEA,MAAMwM,YAAY,GAAG/L,YAAA,CAAa,KAAb,CAArB;AACA,MAAMgM,eAAe,GAAGhM,iBAAA,CAAkB,UAACJ,KAAD;AACxCmM,IAAAA,YAAY,CAACE,OAAb,GAAuB,IAAvB;AACAJ,IAAAA,OAAO,CAACjM,KAAD,CAAP;AACD,GAHuB,EAGrB,EAHqB,CAAxB;;AAMA4L,EAAAA,yBAAyB,CAAC;AACxB,QAAI,CAAC/B,kBAAkB,CAAClK,KAAD,CAAvB,EAAgC;AAChC,QAAM2M,UAAU,GAAGxD,OAAO,CAACC,GAAR,EAAnB;AACA,QAAMwD,WAAW,GAAGD,UAAU,IAAIhB,UAAd,IAA4BS,gBAAhD;;AACA,QAAI1C,IAAI,KAAKkD,WAAb,EAA0B;AACxBN,MAAAA,OAAO,CAACK,UAAU,IAAIhB,UAAd,IAA4BS,gBAA7B,CAAP;AACD;AACF,GAPwB,EAOtB,EAPsB,CAAzB;;AAUAH,EAAAA,yBAAyB,CAAC;AACxB,QAAIO,YAAY,CAACE,OAAjB,EAA0B;AACxB,UAAIhD,IAAJ,EAAU;AACRP,QAAAA,OAAO,CAACG,GAAR,CAAYI,IAAZ;AACD,OAFD,MAEO;AACLP,QAAAA,OAAO,CAACI,KAAR;AACD;AACF;AACF,GARwB,EAQtB,CAACG,IAAD,CARsB,CAAzB;;AAWAuC,EAAAA,yBAAyB,CAAC;AACxB,QAAMU,UAAU,GAAGxD,OAAO,CAACC,GAAR,EAAnB;AACA,QAAIuD,UAAJ,EAAgB;AAChB,QAAME,UAAU,GAAGlB,UAAU,IAAIS,gBAAjC;AACA,QAAIS,UAAU,KAAKnD,IAAnB,EAAyB;AACzB4C,IAAAA,OAAO,CAACO,UAAD,CAAP;AACD,GANwB,EAMtB,CAACnD,IAAD,EAAOiC,UAAP,EAAmBS,gBAAnB,CANsB,CAAzB;;AASAH,EAAAA,yBAAyB,CAAC;AACxB,QAAI,CAACvC,IAAL,EAAW,OAAOW,SAAP;AACX,QAAI,CAACkC,uBAAL,EAA8B,OAAOlC,SAAP;AAC9B,QAAMyC,MAAM,GAAG3D,OAAO,CAACC,GAAR,EAAf;AACA,QAAM2D,OAAO,GAAGV,gBAAgB,KAAK3C,IAArC;AACA,QAAI,CAACoD,MAAD,IAAW,CAACC,OAAhB,EAAyB,OAAO1C,SAAP;AACzB,QAAM2C,SAAS,GAAGvD,qBAAqB,CAACC,IAAD,CAAvC;AACA,QAAMuD,UAAU,GAAGd,MAAM,IAAIe,QAAQ,CAACC,IAAtC;AACAF,IAAAA,UAAU,CAACG,SAAX,CAAqBC,GAArB,CAAyBL,SAAzB;AACA,WAAO;AACLC,MAAAA,UAAU,CAACG,SAAX,CAAqBE,MAArB,CAA4BN,SAA5B;AACD,KAFD;AAGD,GAZwB,EAYtB,CAACT,uBAAD,EAA0BJ,MAA1B,EAAkCzC,IAAlC,EAAwC2C,gBAAxC,CAZsB,CAAzB;AAcA,SAAO,CAAC3C,IAAD,EAAO+C,eAAP,CAAP;AACD;AAED,SAAgBc,kBACdvN,OACA0J;yBAEsBjJ,cAAA,CAAeiJ,IAAf;MAAfkD;;AACP,MAAMY,qBAAqB,GAAG/M,aAAA,CAAc;AAC1C,QAAI,CAACmM,WAAL,EAAkB,OAAO,IAAP;AAClB,QAAI,CAACzC,+BAA+B,CAACnK,KAAD,CAApC,EAA6C,OAAO,IAAP;AAC7C,QAAI,CAACkK,kBAAkB,CAAClK,KAAD,CAAvB,EAAgC,OAAOA,KAAP;;yBACHA,KAAK,CAAC8J;QAA3BC,uBAAAA;QAAUD;;AAClB,QAAMiB,SAAS,GAAGH,gBAAgB,CAACb,KAAD,CAAlC;AAEA,wBACK/J,KADL;AAEE8J,MAAAA,MAAM,eACDA,MADC,EAED9B,4BAA4B,CAC7B8B,MAD6B,EAE7B9J,KAF6B,EAG7B+K,SAH6B,EAI7BpB,qBAJ6B,CAF3B;AAQJI,QAAAA,KAAK,EAALA;AARI,QAFR;AAYE0D,MAAAA,WAAW,EAAEzN,KAAK,CAAC8J;AAZrB;AAcD,GArB6B,EAqB3B,CAAC8C,WAAD,EAAc5M,KAAd,CArB2B,CAA9B;AAuBA,MAAM0N,aAAa,GAAGjN,aAAA,CAAc;AAClC,QAAI,CAACiJ,IAAL,EAAW,OAAO,IAAP;AACX,QAAIS,+BAA+B,CAACnK,KAAD,CAAnC,EAA4C,OAAO,IAAP;AAC5C,QAAI,CAACkK,kBAAkB,CAAClK,KAAD,CAAvB,EAAgC,OAAOA,KAAP;;AAEhC,QAAI0J,IAAI,KAAKc,uBAAuB,CAACxK,KAAD,CAApC,EAA6C;AAC3C,0BAAYA,KAAZ;AAAmB2N,QAAAA,WAAW,EAAEjE;AAAhC;AACD;;AAED,wBACK1J,KADL;AAEE8J,MAAAA,MAAM,eACD9J,KAAK,CAAC8J,MADL,EAED9J,KAAK,CAAC8J,MAAN,CAAaC,KAAb,CAAmBL,IAAnB,CAFC,CAFR;AAMEiE,MAAAA,WAAW,EAAEjE,IANf;AAOE+D,MAAAA,WAAW,EAAEzN,KAAK,CAAC8J;AAPrB;AASD,GAlBqB,EAkBnB,CAAC9J,KAAD,EAAQ0J,IAAR,CAlBmB,CAAtB;AAoBA,SAAQ8D,qBAAqB,IAAIE,aAAjC;AACD;AAED,IAAaE,gBAAgB,gBAAGnN,mBAAA,CAA2C,IAA3C,CAAzB;AAEP,SAAgBoN;AACd,MAAMC,cAAc,GAAGrN,gBAAA,CAAiBmN,gBAAjB,CAAvB;;AAEA,MAAI,CAACE,cAAL,EAAqB;AACnB,UAAM,IAAIC,KAAJ,2DAAN;AACD;;AAED,SAAOD,cAAP;AACD;AAQD,SAAgBE;MACdC,qBAAAA;MACAC,sBAAAA;MACAC,uBAAAA;;AAMA,WAASC,iBAAT;QACEC,iBAAAA;QACAlC,eAAAA;QACArB,uBAAAA;AAEA,QAAM9K,KAAK,GAAGS,gBAAA,CAAiBwN,YAAjB,CAAd;;AACA,QAAI,CAACjO,KAAL,EAAY;AACV,YAAM,IAAI+N,KAAJ,CACJ,8DADI,CAAN;AAGD;;AACD,QAAMO,UAAU,GAAGpC,iBAAiB,CAAClM,KAAD,EAAQ;AAAEmM,MAAAA,MAAM,EAANA;AAAF,KAAR,CAApC;AACA,QAAMoC,cAAc,GAAGhB,iBAAiB,CAACvN,KAAD,EAAQsO,UAAU,CAAC,CAAD,CAAlB,CAAxC;AACA,WACE7N,mBAAA,eAAA,MAAA,EACEA,mBAAA,CAAC0N,cAAD;AAAgBrD,MAAAA,cAAc,EAAEA;KAAhC,CADF,EAEErK,mBAAA,CAACyN,aAAD;AAAelO,MAAAA,KAAK,EAAEuO;KAAtB,EACE9N,mBAAA,CAACmN,gBAAgB,CAACY,QAAlB;AAA2BnO,MAAAA,KAAK,EAAEiO;KAAlC,EACGD,QADH,CADF,CAFF,CADF;AAUD;;AACD,SAAOD,iBAAP;AACD;;AAMD,SAASK,aAAT;kCAE0B;2BADxBtC;MAAAA,mCAAS;;AAET,wEACqCtD,WADrC,2BAEcsD,MAFd,wBAEuC3C,uBAFvC;AAID;;AAED,SAAgBkF,8BACdC;AAEA,SACElO,mBAAA,SAAA;AACEN,IAAAA,GAAG,EAAC;AACJyO,IAAAA,uBAAuB,EAAE;AAAEC,MAAAA,MAAM,EAAEJ,aAAa,CAACE,OAAD;AAAvB;GAF3B,CADF;AAMD;AAED,SAAgBG,0BACdH;AAEA,sBAAkBF,aAAa,CAACE,OAAD,CAA/B;AACD;;;;;;;;;;;;;;;;;;;"}